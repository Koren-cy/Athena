---
tags:
  - 数学
dlink:
  - "[[---概率论基本概念---]]"
aliases:
  - Bayes' Theorem
---
贝叶斯定理描述了如何利用现有证据更新某一事件的概率。
$$
P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)}
$$
其中：
- $P(A|B)$ 是在事件 $B$ 发生的条件下，事件 $A$ 发生的后验概率。在贝叶斯定理中, 也叫[[似然函数|尤度 ]]
- $P(B|A)$ 是在事件 $A$ 发生的条件下，事件 $B$ 发生的条件概率。
- $P(A)$ 是事件 $A$ 的先验概率，即在未考虑事件 $B$ 的情况下，事件 $A$ 发生的概率。
- $P(B)$ 是事件 $B$ 的边缘概率，即事件 $B$ 发生的总概率。

![[Screenshot_20240804_160531_Samsung Notes.jpg]]
### 推导
贝叶斯定理的推导基于条件概率的定义和全概率公式
$$
P(A|B) = \frac{P(A \cap B)}{P(B)}
$$
$$
P(B|A) = \frac{P(A \cap B)}{P(A)}
$$
由此可以得到：
$$
P(A \cap B) = P(A|B) \cdot P(B)
$$
$$
P(A \cap B) = P(B|A) \cdot P(A)
$$
结合两等式得到：
$$
P(A \cap B) = P(A|B) \cdot P(B) = P(B|A) \cdot P(A)
$$
两边同时除以 $P(B)$，即可得出贝叶斯定理：
$$
P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)}
$$

> [!warning] 
> 贝叶斯公式不要求各变量独立

## 示例
这是一个极端的例子, 统计了10个人开车,戴表和是否有钱的信息

| 序号  | 开豪车 | 带名表 | 有钱人 |
| --- | --- | --- | --- |
| 1   | 1   | 1   | 1   |
| 2   | 1   | 1   | 1   |
| 3   | 1   | 1   | 1   |
| 4   | 1   | 1   | 1   |
| 5   | 1   | 1   | 1   |
| 6   | 1   | 1   | 1   |
| 7   | 1   | 1   | 1   |
| 8   | 0   | 1   | 0   |
| 9   | 0   | 1   | 0   |
| 10  | 0   | 0   | 0   |

计算 $P(\text{有钱人} | \text{开豪车} \cap \text{带名表})$，即在已知某人同时开豪车和带名表的情况下，这个人是有钱人的概率。

首先，我们可以从数据中统计出相关事件的频次：

1. **开豪车且带名表的人数** ($\text{开豪车} \cap \text{带名表}$)：观察数据中“开豪车”和“带名表”两列同时为 1 的情况。
2. **开豪车且带名表且是有钱人的人数** ($\text{开豪车} \cap \text{带名表} \cap \text{有钱人}$)：观察数据中“开豪车”、“带名表”和“有钱人”三列同时为 1 的情况。

从表中统计：

- **开豪车且带名表** ($\text{开豪车} = 1$ 且 $\text{带名表} = 1$)：一共 7 人（序号 1 到 7）。
- **开豪车且带名表且是有钱人** ($\text{开豪车} = 1$ 且 $\text{带名表} = 1$ 且 $\text{有钱人} = 1$)：也是 7 人（序号 1 到 7）。

现在，我们可以计算条件概率 $P(\text{有钱人} | \text{开豪车} \cap \text{带名表})$：

$$
P(\text{有钱人} | \text{开豪车} \cap \text{带名表}) = \frac{P(\text{开豪车} \cap \text{带名表} \cap \text{有钱人})}{P(\text{开豪车} \cap \text{带名表})}
$$

由于我们看到这两个事件的人数完全一致，因此：

$$
P(\text{有钱人} | \text{开豪车} \cap \text{带名表}) = \frac{7}{7} = 1
$$

这意味着在开豪车且带名表的个体中，他们是有钱人的概率是 100%。

